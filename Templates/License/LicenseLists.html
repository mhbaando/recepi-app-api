{% extends 'Base/index.html' %}
{% load static %}
{% block content %}
 <!--Page header-->
 <div class="page-header">
    <div class="page-leftheader">
        <h4 class="page-title">New License</h4>
    </div>
    <div class="page-rightheader ms-auto d-lg-flex d-none">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="javascript:void(0)" class="d-flex"><svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 3L2 12h3v8h6v-6h2v6h6v-8h3L12 3zm5 15h-2v-6H9v6H7v-7.81l5-4.5 5 4.5V18z"/><path d="M7 10.19V18h2v-6h6v6h2v-7.81l-5-4.5z" opacity=".3"/></svg><span class="breadcrumb-icon"> Home</span></a></li>
            <li class="breadcrumb-item"><a href="javascript:void(0)">Lecense</a></li>
            <li class="breadcrumb-item active" aria-current="page">New Lecense</li>
        </ol>
    </div>
</div>

<!--End Page header-->

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Licence Lists</div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <div class="row mb-2 g-4 align-items-center">

                        <div class="col-sm-auto ms-auto">
                            <div class="hstack gap-2">

                                <div class="form-group">
                                    <label class="form-label">Status</label>
                                    <select id="Status" name="Status" Status={{ Status }}
                                        class="form-control select2 w-100">
                                        <option value="Active">Active</option>
                                        <option value="Lost">Lost</option>
                                        <option value="Suspended">Suspended</option>
                                      
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Page</label>
                                    <select id="DataNumber" name="DataNumber" DataNumber={{ DataNumber }}
                                        class="form-control select2 w-100">
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="30">30</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>

                                <form autocomplete='off'>
                                    <div class="input-group mr-0">
                                        <input id="SearchQuery" type="text" placeholder="Search..."
                                            value='{{SearchQuery}}' class="form-control"
                                            aria-label="Recipient's username" aria-describedby="button-addon2">
                                        <button class="btn btn-primary" type="button" id="button-addon2">
                                            <i class="bx bx-search"></i>
                                        </button>
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>
                    <table class="table table-bordered text-nowrap">
                        <thead>
                            <tr>
                                <th class="wd-15p border-bottom-0">License No</th>
                                <th class="wd-15p border-bottom-0">Ownar Name</th>
                                <th class="wd-20p border-bottom-0">Registered Date</th>
                                <th class="wd-15p border-bottom-0">Expire Date</th>
                                <th class="wd-10p border-bottom-0">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if licenselist %}
                            {% for item in licenselist %}
                            <tr>
            
                            <td>{{item.lno}}</td>
                            <td>{{item.ownar}}</td>
                            <td>{{item.register}}</td>
                            <td>{{item.expire}}</td>
            
                            <td>
                                <span
                                    class="badge bg-{% if item.status == 'Active' %}success{% elif item.status == 'suspended'%}warning{% else %}danger{% endif %}">{{item.status}}</span>
                            </td>
                           
                           
                             </tr>
                        {% endfor %}
                        {% else %}
                        <tr>
                            <td class='text-center' colspan='9'>No license available</td>
                        </tr>
                        {% endif %}
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
{% block scriptData %}


<script>
    
   
    
    $("#DataNumber").val($("#DataNumber").attr("DataNumber"));
    $("#Status").val($("#Status").attr("Status"));
   
    $("#DataNumber").change(function () {
        RefreshPage();
    });
    $("#Status").change(function () {
        RefreshPage();
      });
      

    $("#SearchQuery").on("change", function () {
        RefreshPage();
    });

    $("#SearchQueryBTN").on("click", function () {
        RefreshPage();
    });

    $(".pagination .page-item").on("click", function () {
        const pageNumber = $(this).attr("page");
        $(".activePage").attr("activePage", pageNumber);
        RefreshPage();
    });

    function RefreshPage() {
        let page = $(".activePage").attr("activePage");
        let search = $("#SearchQuery").val();
        let entries = $("#DataNumber").val();
        let Status = $("#Status").val();

        let url = ''

        if (search != '') {
            url = 
                `/license_lists?DataNumber=${entries}&Status=${Status}&SearchQuery=${search}&page=${page}`
        }

        else {
            url = 
                `/license_lists?DataNumber=${entries}&Status=${Status}&page=${page}`
        }

        window.location.replace(url);
    }

</script>
<!-- Data tables -->
<!-- <script src={% static "assets/plugins/datatable/js/jquery.dataTables.min.js"%}></script>
<script src={% static "assets/plugins/datatable/js/dataTables.bootstrap5.js"%}></script>
<script src={% static "assets/plugins/datatable/js/dataTables.buttons.min.js"%}></script>
<script src={% static "assets/plugins/datatable/js/buttons.bootstrap5.min.js"%}></script>
<script src={% static "assets/plugins/datatable/js/jszip.min.js"%}></script>
<script src={% static "assets/plugins/datatable/pdfmake/pdfmake.min.js"%}></script>
<script src={% static "assets/plugins/datatable/pdfmake/vfs_fonts.js"%}></script>
<script src={% static "assets/plugins/datatable/js/buttons.html5.min.js"%}></script>
<script src={% static "assets/plugins/datatable/js/buttons.print.min.js"%}></script>
<script src={% static "assets/plugins/datatable/js/buttons.colVis.min.js"%}></script>
<script src={% static "assets/plugins/datatable/dataTables.responsive.min.js"%}></script>
<script src={% static "assets/plugins/datatable/responsive.bootstrap5.min.js"%}></script>
<script src={% static "assets/js/datatables.js"%}></script> -->
{% endblock scriptData %}